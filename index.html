<meta charset=utf-8>
<canvas id=a width=640 height=480></canvas>

<script>
// Based on http://codentronix.com/2011/04/20/simulation-of-3d-point-rotation-with-python-and-pygame/

rotateX = (point, angle) => {
  rad = angle * Math.PI / 180
  cosa = Math.cos(rad)
  sina = Math.sin(rad)
  y = point.y * cosa - point.z * sina
  z = point.y * sina + point.z * cosa
  return Point3D(point.x, y, z)
}

rotateY = (point, angle) => {
  rad = angle * Math.PI / 180
  cosa = Math.cos(rad)
  sina = Math.sin(rad)
  z = point.z * cosa - point.x * sina
  x = point.z * sina + point.x * cosa
  return {x:x, y:point.y, z:z}
}

rotateZ = (point, angle) => {
  rad = angle * Math.PI / 180
  cosa = Math.cos(rad)
  sina = Math.sin(rad)
  x = point.x * cosa - point.y * sina
  y = point.x * sina + point.y * cosa
  return {x:x, y:y, z:point.z}
}

project = (point, win_width, win_height, fov, viewer_distance) => {
  factor = fov / (viewer_distance + point.z)
  x = point.x * factor + win_width / 2
  y = -point.y * factor + win_height / 2
  return {x:x, y:y, z:1}
}

Point3D = (x, y, z) => {
  return {x:x, y:y, z:z}
}

init = () => {

  c = a.getContext("2d")

  vertices = [
    Point3D(-1,1,-1),
    Point3D(1,1,-1),
    Point3D(1,-1,-1),
    Point3D(-1,-1,-1),
    Point3D(-1,1,1),
    Point3D(1,1,1),
    Point3D(1,-1,1),
    Point3D(-1,-1,1)
  ]

  angleX = angleY = angleZ = 0
}

run = () => {

  a.width = a.width
  for(v in vertices){
    r = vertices[v]
    r = rotateX(r, angleX)
    r = rotateY(r, angleY)
    r = rotateZ(r, angleZ)
    p = project(r, a.width, a.height, 256, 4)
    x = p.x
    y = p.y
    c.fillRect(x,y,factor/10, factor/10)
  }

  self.angleX += 1
  self.angleY += 1
  self.angleZ += 1
}

init()

setInterval(run, 33)

</script>